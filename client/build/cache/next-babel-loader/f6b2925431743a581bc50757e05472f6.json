{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\n\nvar _jsxFileName = \"/mnt/d/G1T3-frontend/client/components/front/LoginForm.js\",\n    _s = $RefreshSig$();\n\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport Router from 'next/router';\nimport Alert from \"./alerts/Alert\";\nimport { useAuth } from '../../providers/Auth';\nimport { useState } from 'react';\nexport default function LoginForm(_ref) {\n  _s();\n\n  var setLoading = _ref.setLoading,\n      stopLoading = _ref.stopLoading;\n\n  var _useState = useState(null),\n      email = _useState[0],\n      setEmail = _useState[1];\n\n  var _useState2 = useState(null),\n      password = _useState2[0],\n      setPassword = _useState2[1];\n\n  var _useState3 = useState(false),\n      error = _useState3[0],\n      setError = _useState3[1];\n\n  var _useState4 = useState(null),\n      status = _useState4[0],\n      setStatus = _useState4[1]; //const url = 'https://g1t3-node-auth-srv.cfapps.us10.hana.ondemand.com/api/login';\n  //const url = 'http://localhost:5000/api/login';\n\n\n  var url = '/api/login';\n  var auth = useAuth();\n\n  var closeAlert = function closeAlert(e) {\n    setError(false);\n  };\n\n  var handleChange = function handleChange(e) {\n    var id = e.target.getAttribute('id');\n\n    if (id == 'email') {\n      setEmail(e.target.value);\n    } else if (id == 'login-password') {\n      setPassword(e.target.value);\n    }\n\n    ;\n  };\n\n  var handleSubmit = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(e) {\n      var requestOptions, response, data;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              setLoading();\n              e.preventDefault();\n              requestOptions = {\n                method: 'POST',\n                headers: {\n                  'Content-Type': 'application/json'\n                },\n                credentials: 'include',\n                body: JSON.stringify({\n                  \"email\": email,\n                  \"password\": password\n                })\n              };\n              _context.prev = 3;\n              _context.next = 6;\n              return fetch(url, requestOptions);\n\n            case 6:\n              response = _context.sent;\n\n              if (!response.ok) {\n                _context.next = 18;\n                break;\n              }\n\n              _context.next = 10;\n              return response.json();\n\n            case 10:\n              data = _context.sent;\n              console.log(\"logged in!\");\n              auth.setName(data.email);\n              auth.setRole(data.role);\n              auth.setAuth(true);\n              Router.push('/home');\n              _context.next = 20;\n              break;\n\n            case 18:\n              // invalid params\n              setError(true);\n              setStatus('Wrong email or password!');\n\n            case 20:\n              _context.next = 26;\n              break;\n\n            case 22:\n              _context.prev = 22;\n              _context.t0 = _context[\"catch\"](3);\n              setError(true);\n              setStatus('Auth server might be down!');\n\n            case 26:\n              stopLoading();\n\n            case 27:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[3, 22]]);\n    }));\n\n    return function handleSubmit(_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var wrapperFunction = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(e) {\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              handleSubmit(e);\n\n            case 1:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function wrapperFunction(_x2) {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  return __jsx(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 9\n    }\n  }, error ? __jsx(Alert, {\n    status: status,\n    close: closeAlert,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 23\n    }\n  }) : null, __jsx(\"form\", {\n    onSubmit: wrapperFunction,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 13\n    }\n  }, __jsx(\"div\", {\n    className: \"mb-4\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 17\n    }\n  }, __jsx(\"label\", {\n    className: \"block text-gray-700 text-sm font-bold mb-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 21\n    }\n  }, \"Email\"), __jsx(\"input\", {\n    required: true,\n    onChange: handleChange,\n    className: \"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline\",\n    id: \"email\",\n    type: \"email\",\n    placeholder: \"Email\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 21\n    }\n  })), __jsx(\"div\", {\n    className: \"mb-6\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 17\n    }\n  }, __jsx(\"label\", {\n    className: \"block text-gray-700 text-sm font-bold mb-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 21\n    }\n  }, \"Password\"), __jsx(\"input\", {\n    required: true,\n    onChange: handleChange,\n    className: \"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 mb-3 leading-tight focus:outline-none focus:shadow-outline\",\n    id: \"login-password\",\n    type: \"password\",\n    placeholder: \"******************\",\n    autoComplete: \"off\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 21\n    }\n  }), __jsx(\"p\", {\n    className: \"text-red-500 text-xs italic hidden\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 21\n    }\n  }, \"Please choose a password.\")), __jsx(\"div\", {\n    className: \"mb-6\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 17\n    }\n  }, __jsx(\"input\", {\n    className: \"cursor-pointer w-full bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline\",\n    type: \"submit\",\n    id: \"login\",\n    name: \"login\",\n    value: \"Login\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 17\n    }\n  }), __jsx(\"p\", {\n    className: \"lg:flex lg:justify-center font-bold text-sm text-blue-500 hover:text-blue-800 mt-5\",\n    href: \"#\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 21\n    }\n  }, \"Forgot Password?\"))));\n}\n\n_s(LoginForm, \"g+A0wYT9M6h4V+Tw05z9besSWDw=\", false, function () {\n  return [useAuth];\n});\n\n_c = LoginForm;\n\nvar _c;\n\n$RefreshReg$(_c, \"LoginForm\");","map":{"version":3,"sources":["/mnt/d/G1T3-frontend/client/components/front/LoginForm.js"],"names":["Router","Alert","useAuth","useState","LoginForm","setLoading","stopLoading","email","setEmail","password","setPassword","error","setError","status","setStatus","url","auth","closeAlert","e","handleChange","id","target","getAttribute","value","handleSubmit","preventDefault","requestOptions","method","headers","credentials","body","JSON","stringify","fetch","response","ok","json","data","console","log","setName","setRole","role","setAuth","push","wrapperFunction"],"mappings":"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","sourcesContent":["import Router from 'next/router'\nimport Alert from \"./alerts/Alert\";\nimport { useAuth } from '../../providers/Auth';\nimport { useState } from 'react';\n\nexport default function LoginForm({setLoading, stopLoading}) {\n    const [email, setEmail] = useState(null);\n    const [password, setPassword] = useState(null);\n    const [error, setError] = useState(false);\n    const [status, setStatus] = useState(null);\n    \n    //const url = 'https://g1t3-node-auth-srv.cfapps.us10.hana.ondemand.com/api/login';\n    //const url = 'http://localhost:5000/api/login';\n    const url = '/api/login';\n    const auth = useAuth();\n\n    const closeAlert = (e) => {\n        setError(false);\n    }\n\n    const handleChange = (e) => {\n        let id = e.target.getAttribute('id'); \n\n        if (id == 'email') {\n            setEmail(e.target.value);\n        } \n        else if (id == 'login-password') {\n            setPassword(e.target.value);\n        };\n    }\n\n    const handleSubmit = async (e) => {\n        setLoading();\n        e.preventDefault();\n\n        const requestOptions = {\n            method: 'POST',\n            headers: { 'Content-Type': 'application/json' },\n            credentials: 'include',\n            body: JSON.stringify({\n                \"email\": email,\n                \"password\": password\n            })\n        };\n\n        try {\n            const response = await fetch(url, requestOptions);\n            if (response.ok) {\n                const data = await response.json();\n                console.log(\"logged in!\");\n                auth.setName(data.email);\n                auth.setRole(data.role);\n                auth.setAuth(true);\n                Router.push('/home')\n            }\n            else {\n                // invalid params\n                setError(true);\n                setStatus('Wrong email or password!');\n            }\n        } catch (error) {\n            setError(true);\n            setStatus('Auth server might be down!');\n        }\n        stopLoading();\n    }\n\n    const wrapperFunction = async (e) => {\n        handleSubmit(e);\n    }\n\n    return (\n        <div>\n            { error ? <Alert status={status} close={closeAlert}/> : null }\n            <form onSubmit={wrapperFunction}>\n                <div className=\"mb-4\">\n                    <label className=\"block text-gray-700 text-sm font-bold mb-2\">\n                        Email\n                    </label>\n                    <input required onChange={handleChange} className=\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline\" id=\"email\" type=\"email\" placeholder=\"Email\" />\n                </div>\n\n                <div className=\"mb-6\">\n                    <label className=\"block text-gray-700 text-sm font-bold mb-2\">\n                        Password\n                    </label>\n                    <input required onChange={handleChange} className=\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 mb-3 leading-tight focus:outline-none focus:shadow-outline\" id=\"login-password\" type=\"password\" placeholder=\"******************\" autoComplete=\"off\" />\n                    <p className=\"text-red-500 text-xs italic hidden\">Please choose a password.</p>\n                </div>\n                \n                <div className=\"mb-6\">\n                <input className=\"cursor-pointer w-full bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline\" type=\"submit\" id=\"login\" name=\"login\" value=\"Login\" />\n                    <p className=\"lg:flex lg:justify-center font-bold text-sm text-blue-500 hover:text-blue-800 mt-5\" href=\"#\">Forgot Password?</p>\n                </div>\n            </form>\n        </div>\n    )\n}\n"]},"metadata":{},"sourceType":"module"}