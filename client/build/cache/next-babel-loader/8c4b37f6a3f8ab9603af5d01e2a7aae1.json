{"ast":null,"code":"import _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/esm/getPrototypeOf\";\nvar _jsxFileName = \"/Users/seanjin/Documents/EBS/project/G1T3-frontend/client/components/foodbasket/Basket.js\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nimport { Grid, Container } from '@material-ui/core';\nimport React, { Component } from 'react';\nimport MainCard from './Cards/MainCard.js';\nimport BasketCard from './Cards/BasketCard.js';\nimport StockCard from './Cards/StockCard.js';\nimport { v5 as uuid } from 'uuid';\n\nvar Basket = /*#__PURE__*/function (_Component) {\n  _inherits(Basket, _Component);\n\n  var _super = _createSuper(Basket);\n\n  function Basket(props) {\n    var _this;\n\n    _classCallCheck(this, Basket);\n\n    _this = _super.call(this, props);\n    _this.state = {\n      basket: props.data.basket,\n      allStocks: props.data.allStocks,\n      basketItems: null,\n      selectedBasket: null,\n      editMode: false\n    };\n    _this.expandBasket = _this.expandBasket.bind(_assertThisInitialized(_this));\n    _this.resetShowBasket = _this.resetShowBasket.bind(_assertThisInitialized(_this));\n    _this.showAllStocks = _this.showAllStocks.bind(_assertThisInitialized(_this));\n    _this.handleIncrement = _this.handleIncrement.bind(_assertThisInitialized(_this));\n    _this.handleDecrement = _this.handleDecrement.bind(_assertThisInitialized(_this));\n    _this.saveBasket = _this.saveBasket.bind(_assertThisInitialized(_this));\n    _this.createBasket = _this.createBasket.bind(_assertThisInitialized(_this));\n    return _this;\n  }\n\n  _createClass(Basket, [{\n    key: \"resetShowBasket\",\n    value: function resetShowBasket() {\n      this.setState({\n        selectedBasket: null,\n        basketItems: null,\n        editMode: false\n      });\n    }\n  }, {\n    key: \"expandBasket\",\n    value: function expandBasket(item) {\n      this.setState({\n        basketItems: item.stocks,\n        selectedBasket: item.BasketID\n      });\n    }\n  }, {\n    key: \"showAllStocks\",\n    value: function showAllStocks() {\n      this.setState({\n        editMode: true\n      });\n    }\n  }, {\n    key: \"handleIncrement\",\n    value: function handleIncrement(item) {\n      var _this$state = this.state,\n          basketItems = _this$state.basketItems,\n          selectedBasket = _this$state.selectedBasket;\n\n      if (basketItems === null) {\n        return;\n      }\n\n      var id = item.stock_stockID;\n      var itemExist = basketItems.filter(function (obj) {\n        return obj.stock_stock_stockID === id;\n      });\n\n      if (itemExist && itemExist.length) {\n        var updatedBasket = basketItems.map(function (obj) {\n          if (obj.stock_stock_stockID === id) {\n            return _objectSpread(_objectSpread({}, obj), {}, {\n              quantity: obj.quantity + 1\n            });\n          } else {\n            return obj;\n          }\n        });\n        this.setState({\n          basketItems: updatedBasket\n        });\n        return;\n      } else {\n        var updatedItem = {\n          quantity: 1,\n          basket_BasketID: selectedBasket,\n          stock_charities_charityID: 'charity001',\n          stock_stock_stockID: id,\n          stock_stock_name: item.stock_name\n        };\n\n        var _updatedBasket = [].concat(_toConsumableArray(basketItems), [updatedItem]);\n\n        this.setState({\n          basketItems: _updatedBasket\n        });\n        return;\n      }\n    }\n  }, {\n    key: \"handleDecrement\",\n    value: function handleDecrement(item) {\n      var _this$state2 = this.state,\n          basketItems = _this$state2.basketItems,\n          selectedBasket = _this$state2.selectedBasket,\n          editMode = _this$state2.editMode;\n\n      if (!editMode) {\n        return;\n      }\n\n      var id = item.stock_stock_stockID;\n      var itemToUpdate = basketItems.filter(function (obj) {\n        return obj.stock_stock_stockID === id;\n      })[0];\n\n      if (itemToUpdate.quantity === 1) {\n        var updatedBasket = basketItems.filter(function (obj) {\n          return obj.stock_stock_stockID !== id;\n        });\n        this.setState({\n          basketItems: updatedBasket\n        });\n        return;\n      } else {\n        var _updatedBasket2 = basketItems.map(function (obj) {\n          if (obj.stock_stock_stockID === id) {\n            return _objectSpread(_objectSpread({}, obj), {}, {\n              quantity: obj.quantity - 1\n            });\n          } else {\n            return obj;\n          }\n        });\n\n        this.setState({\n          basketItems: _updatedBasket2\n        });\n      }\n    }\n  }, {\n    key: \"saveBasket\",\n    value: function saveBasket() {\n      var _this$state3 = this.state,\n          basket = _this$state3.basket,\n          basketItems = _this$state3.basketItems,\n          selectedBasket = _this$state3.selectedBasket,\n          editMode = _this$state3.editMode;\n      var basketToUpdate = basket.find(function (item) {\n        return item.BasketID === selectedBasket;\n      });\n\n      var updatedBasket = _objectSpread(_objectSpread({}, basketToUpdate), {}, {\n        stocks: basketItems\n      });\n\n      var updatedAllBaskets = basket.map(function (item) {\n        if (item.BasketID === selectedBasket) {\n          return updatedBasket;\n        } else {\n          return item;\n        }\n      });\n      this.setState({\n        basket: updatedAllBaskets,\n        editMode: false\n      });\n    }\n  }, {\n    key: \"createBasket\",\n    value: function createBasket(e) {\n      if (e.key !== 'Enter') {\n        return;\n      }\n\n      var basket = this.state.basket;\n      console.log(basket);\n      var id = uuid.v4();\n      console.log(id); // TODO: create new basket\n    } // PUT API\n    // const url =\n    // \t'https://smucf-dev-ebs-g1t3-srv.cfapps.us10.hana.ondemand.com/api/Basket/' +\n    // \tselectedBasket;\n    // fetch(url, {\n    // \theaders: { 'Content-Type': 'application/json' },\n    // \tmethod: 'PUT',\n    // \tbody: JSON.stringify({\n    // \t\tBasketID: selectedBasket,\n    // \t\tname: basketToUpdate.name,\n    // \t\tstocks: basketToUpdate.stocks,\n    // \t}),\n    // });\n\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$state4 = this.state,\n          basket = _this$state4.basket,\n          allStocks = _this$state4.allStocks,\n          basketItems = _this$state4.basketItems,\n          editMode = _this$state4.editMode;\n      return __jsx(\"div\", {\n        className: \"container mx-auto px-4 sm:px-8 mt-18 flex-grow h-full\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 152,\n          columnNumber: 4\n        }\n      }, __jsx(\"div\", {\n        className: \"py-8 flex-grow flex-col flex bg-white shadow-lg rounded px-8 pt-6 pb-8 mb-4 mt-4 h-auto\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 153,\n          columnNumber: 5\n        }\n      }, __jsx(Grid, {\n        container: true,\n        direction: \"row\",\n        justify: \"flex-start\",\n        alignItems: \"flex-start\",\n        spacing: 4,\n        className: \"flex flex-row\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 154,\n          columnNumber: 6\n        }\n      }, __jsx(Grid, {\n        item: true,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 162,\n          columnNumber: 7\n        }\n      }, __jsx(MainCard, {\n        onClick: this.expandBasket,\n        clickReset: this.resetShowBasket,\n        data: basket,\n        createBasket: this.createBasket,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 163,\n          columnNumber: 8\n        }\n      }, \"Presets\")), __jsx(Grid, {\n        item: true,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 173,\n          columnNumber: 7\n        }\n      }, __jsx(BasketCard, {\n        onClickEdit: this.showAllStocks,\n        onClickRemove: this.handleDecrement,\n        onClickSave: this.saveBasket,\n        data: basketItems,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 174,\n          columnNumber: 8\n        }\n      }, \"Food Items\")), __jsx(Grid, {\n        item: true,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 184,\n          columnNumber: 7\n        }\n      }, __jsx(StockCard, {\n        increment: this.handleIncrement,\n        checker: editMode,\n        data: allStocks,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 185,\n          columnNumber: 8\n        }\n      }, \"All Stocks\")))));\n    }\n  }]);\n\n  return Basket;\n}(Component);\n\nexport default Basket;","map":{"version":3,"sources":["/Users/seanjin/Documents/EBS/project/G1T3-frontend/client/components/foodbasket/Basket.js"],"names":["Grid","Container","React","Component","MainCard","BasketCard","StockCard","v5","uuid","Basket","props","state","basket","data","allStocks","basketItems","selectedBasket","editMode","expandBasket","bind","resetShowBasket","showAllStocks","handleIncrement","handleDecrement","saveBasket","createBasket","setState","item","stocks","BasketID","id","stock_stockID","itemExist","filter","obj","stock_stock_stockID","length","updatedBasket","map","quantity","updatedItem","basket_BasketID","stock_charities_charityID","stock_stock_name","stock_name","itemToUpdate","basketToUpdate","find","updatedAllBaskets","e","key","console","log","v4"],"mappings":"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","sourcesContent":["import { Grid, Container } from '@material-ui/core';\nimport React, { Component } from 'react';\nimport MainCard from './Cards/MainCard.js';\nimport BasketCard from './Cards/BasketCard.js';\nimport StockCard from './Cards/StockCard.js';\nimport { v5 as uuid } from 'uuid';\n\nclass Basket extends Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.state = {\n\t\t\tbasket: props.data.basket,\n\t\t\tallStocks: props.data.allStocks,\n\t\t\tbasketItems: null,\n\t\t\tselectedBasket: null,\n\t\t\teditMode: false,\n\t\t};\n\n\t\tthis.expandBasket = this.expandBasket.bind(this);\n\t\tthis.resetShowBasket = this.resetShowBasket.bind(this);\n\t\tthis.showAllStocks = this.showAllStocks.bind(this);\n\t\tthis.handleIncrement = this.handleIncrement.bind(this);\n\t\tthis.handleDecrement = this.handleDecrement.bind(this);\n\t\tthis.saveBasket = this.saveBasket.bind(this);\n\t\tthis.createBasket = this.createBasket.bind(this);\n\t}\n\n\tresetShowBasket() {\n\t\tthis.setState({\n\t\t\tselectedBasket: null,\n\t\t\tbasketItems: null,\n\t\t\teditMode: false,\n\t\t});\n\t}\n\texpandBasket(item) {\n\t\tthis.setState({\n\t\t\tbasketItems: item.stocks,\n\t\t\tselectedBasket: item.BasketID,\n\t\t});\n\t}\n\n\tshowAllStocks() {\n\t\tthis.setState({ editMode: true });\n\t}\n\n\thandleIncrement(item) {\n\t\tconst { basketItems, selectedBasket } = this.state;\n\n\t\tif (basketItems === null) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst id = item.stock_stockID;\n\t\tconst itemExist = basketItems.filter(\n\t\t\t(obj) => obj.stock_stock_stockID === id\n\t\t);\n\t\tif (itemExist && itemExist.length) {\n\t\t\tconst updatedBasket = basketItems.map((obj) => {\n\t\t\t\tif (obj.stock_stock_stockID === id) {\n\t\t\t\t\treturn { ...obj, quantity: obj.quantity + 1 };\n\t\t\t\t} else {\n\t\t\t\t\treturn obj;\n\t\t\t\t}\n\t\t\t});\n\t\t\tthis.setState({ basketItems: updatedBasket });\n\t\t\treturn;\n\t\t} else {\n\t\t\tconst updatedItem = {\n\t\t\t\tquantity: 1,\n\t\t\t\tbasket_BasketID: selectedBasket,\n\t\t\t\tstock_charities_charityID: 'charity001',\n\t\t\t\tstock_stock_stockID: id,\n\t\t\t\tstock_stock_name: item.stock_name,\n\t\t\t};\n\t\t\tconst updatedBasket = [...basketItems, updatedItem];\n\t\t\tthis.setState({ basketItems: updatedBasket });\n\t\t\treturn;\n\t\t}\n\t}\n\n\thandleDecrement(item) {\n\t\tconst { basketItems, selectedBasket, editMode } = this.state;\n\t\tif (!editMode) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst id = item.stock_stock_stockID;\n\t\tconst itemToUpdate = basketItems.filter(\n\t\t\t(obj) => obj.stock_stock_stockID === id\n\t\t)[0];\n\n\t\tif (itemToUpdate.quantity === 1) {\n\t\t\tconst updatedBasket = basketItems.filter(\n\t\t\t\t(obj) => obj.stock_stock_stockID !== id\n\t\t\t);\n\t\t\tthis.setState({ basketItems: updatedBasket });\n\t\t\treturn;\n\t\t} else {\n\t\t\tconst updatedBasket = basketItems.map((obj) => {\n\t\t\t\tif (obj.stock_stock_stockID === id) {\n\t\t\t\t\treturn { ...obj, quantity: obj.quantity - 1 };\n\t\t\t\t} else {\n\t\t\t\t\treturn obj;\n\t\t\t\t}\n\t\t\t});\n\t\t\tthis.setState({ basketItems: updatedBasket });\n\t\t}\n\t}\n\n\tsaveBasket() {\n\t\tconst { basket, basketItems, selectedBasket, editMode } = this.state;\n\t\tconst basketToUpdate = basket.find(\n\t\t\t(item) => item.BasketID === selectedBasket\n\t\t);\n\t\tconst updatedBasket = { ...basketToUpdate, stocks: basketItems };\n\t\tconst updatedAllBaskets = basket.map((item) => {\n\t\t\tif (item.BasketID === selectedBasket) {\n\t\t\t\treturn updatedBasket;\n\t\t\t} else {\n\t\t\t\treturn item;\n\t\t\t}\n\t\t});\n\t\tthis.setState({ basket: updatedAllBaskets, editMode: false });\n\t}\n\tcreateBasket(e) {\n\t\tif (e.key !== 'Enter') {\n\t\t\treturn;\n\t\t}\n\t\tconst { basket } = this.state;\n\t\tconsole.log(basket);\n\t\tconst id = uuid.v4();\n\t\tconsole.log(id);\n\t\t// TODO: create new basket\n\t}\n\t// PUT API\n\t// const url =\n\t// \t'https://smucf-dev-ebs-g1t3-srv.cfapps.us10.hana.ondemand.com/api/Basket/' +\n\t// \tselectedBasket;\n\t// fetch(url, {\n\t// \theaders: { 'Content-Type': 'application/json' },\n\t// \tmethod: 'PUT',\n\t// \tbody: JSON.stringify({\n\t// \t\tBasketID: selectedBasket,\n\t// \t\tname: basketToUpdate.name,\n\t// \t\tstocks: basketToUpdate.stocks,\n\t// \t}),\n\t// });\n\n\trender() {\n\t\tconst { basket, allStocks, basketItems, editMode } = this.state;\n\t\treturn (\n\t\t\t<div className='container mx-auto px-4 sm:px-8 mt-18 flex-grow h-full'>\n\t\t\t\t<div className='py-8 flex-grow flex-col flex bg-white shadow-lg rounded px-8 pt-6 pb-8 mb-4 mt-4 h-auto'>\n\t\t\t\t\t<Grid\n\t\t\t\t\t\tcontainer\n\t\t\t\t\t\tdirection='row'\n\t\t\t\t\t\tjustify='flex-start'\n\t\t\t\t\t\talignItems='flex-start'\n\t\t\t\t\t\tspacing={4}\n\t\t\t\t\t\tclassName='flex flex-row'\n\t\t\t\t\t>\n\t\t\t\t\t\t<Grid item>\n\t\t\t\t\t\t\t<MainCard\n\t\t\t\t\t\t\t\tonClick={this.expandBasket}\n\t\t\t\t\t\t\t\tclickReset={this.resetShowBasket}\n\t\t\t\t\t\t\t\tdata={basket}\n\t\t\t\t\t\t\t\tcreateBasket={this.createBasket}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\tPresets\n\t\t\t\t\t\t\t</MainCard>\n\t\t\t\t\t\t</Grid>\n\n\t\t\t\t\t\t<Grid item>\n\t\t\t\t\t\t\t<BasketCard\n\t\t\t\t\t\t\t\tonClickEdit={this.showAllStocks}\n\t\t\t\t\t\t\t\tonClickRemove={this.handleDecrement}\n\t\t\t\t\t\t\t\tonClickSave={this.saveBasket}\n\t\t\t\t\t\t\t\tdata={basketItems}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\tFood Items\n\t\t\t\t\t\t\t</BasketCard>\n\t\t\t\t\t\t</Grid>\n\n\t\t\t\t\t\t<Grid item>\n\t\t\t\t\t\t\t<StockCard\n\t\t\t\t\t\t\t\tincrement={this.handleIncrement}\n\t\t\t\t\t\t\t\tchecker={editMode}\n\t\t\t\t\t\t\t\tdata={allStocks}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\tAll Stocks\n\t\t\t\t\t\t\t</StockCard>\n\t\t\t\t\t\t</Grid>\n\t\t\t\t\t</Grid>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default Basket;\n"]},"metadata":{},"sourceType":"module"}