{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"/mnt/d/G1T3-frontend/client/providers/Auth.js\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$(),\n    _s3 = $RefreshSig$(),\n    _s4 = $RefreshSig$(),\n    _s5 = $RefreshSig$();\n\nvar __jsx = React.createElement;\nimport React, { useEffect } from 'react'; // set context\n\nvar AuthContext = /*#__PURE__*/React.createContext({\n  name: null,\n  role: null,\n  isAuthenticated: false,\n  isLoading: true // setAuthenticated: () => {},\n\n}); // wraps around children component and add context\n\nexport var AuthProvider = function AuthProvider(_ref) {\n  _s();\n\n  var children = _ref.children;\n\n  var _React$useState = React.useState(null),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      name = _React$useState2[0],\n      setName = _React$useState2[1];\n\n  var _React$useState3 = React.useState(null),\n      _React$useState4 = _slicedToArray(_React$useState3, 2),\n      role = _React$useState4[0],\n      setRole = _React$useState4[1];\n\n  var _React$useState5 = React.useState(false),\n      _React$useState6 = _slicedToArray(_React$useState5, 2),\n      isAuthenticated = _React$useState6[0],\n      setAuthenticated = _React$useState6[1];\n\n  var _React$useState7 = React.useState(true),\n      _React$useState8 = _slicedToArray(_React$useState7, 2),\n      isLoading = _React$useState8[0],\n      setLoading = _React$useState8[1];\n\n  var setAuth = function setAuth(value) {\n    return setAuthenticated(value);\n  }; // verify cookie against server\n\n\n  useEffect(function () {\n    var initializeAuth = /*#__PURE__*/function () {\n      var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        var response, data, _role;\n\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                if (!isAuthenticated) {\n                  _context.next = 3;\n                  break;\n                }\n\n                console.log('already authenticated');\n                return _context.abrupt(\"return\");\n\n              case 3:\n                _context.prev = 3;\n                _context.next = 6;\n                return fetch('/api/auth/verify', {\n                  credentials: 'include'\n                });\n\n              case 6:\n                response = _context.sent;\n\n                if (!(response.status === 200)) {\n                  _context.next = 19;\n                  break;\n                }\n\n                console.log('server okay');\n                _context.next = 11;\n                return response.json();\n\n              case 11:\n                data = _context.sent;\n                setAuthenticated(true);\n                setLoading(false);\n                setName(data.name);\n                _role = data.role;\n                setRole(_role);\n                _context.next = 21;\n                break;\n\n              case 19:\n                // console.log(response.statusText);\n                console.log('not authenticated');\n                setLoading(false);\n\n              case 21:\n                _context.next = 27;\n                break;\n\n              case 23:\n                _context.prev = 23;\n                _context.t0 = _context[\"catch\"](3);\n                console.log('server might be down');\n                setLoading(false);\n\n              case 27:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, null, [[3, 23]]);\n      }));\n\n      return function initializeAuth() {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n\n    initializeAuth();\n  }, []);\n  return __jsx(AuthContext.Provider, {\n    value: {\n      isAuthenticated: isAuthenticated,\n      isLoading: isLoading,\n      name: name,\n      role: role,\n      setAuth: setAuth,\n      setName: setName,\n      setRole: setRole\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 3\n    }\n  }, children);\n};\n\n_s(AuthProvider, \"aU1R1mSB7St1FHT5mR+urfV0Vaw=\");\n\n_c = AuthProvider;\nexport function useAuth() {\n  _s2();\n\n  var context = React.useContext(AuthContext);\n\n  if (context === undefined) {\n    throw new Error('missing AuthProvider');\n  }\n\n  return context;\n}\n\n_s2(useAuth, \"b9L3QQ+jgeyIrH0NfHrJ8nn7VMU=\");\n\nexport function useIsAuthenticated() {\n  _s3();\n\n  var context = useAuth();\n  return context.isAuthenticated;\n}\n\n_s3(useIsAuthenticated, \"KgTufo3Mzyn8NE8NAukDbsEFzJk=\", false, function () {\n  return [useAuth];\n});\n\nexport function getName() {\n  _s4();\n\n  var context = useAuth();\n  return context.name;\n}\n\n_s4(getName, \"KgTufo3Mzyn8NE8NAukDbsEFzJk=\", false, function () {\n  return [useAuth];\n});\n\nexport function getRole() {\n  _s5();\n\n  var context = useAuth();\n  return context.role;\n}\n\n_s5(getRole, \"KgTufo3Mzyn8NE8NAukDbsEFzJk=\", false, function () {\n  return [useAuth];\n});\n\nvar _c;\n\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"sources":["/mnt/d/G1T3-frontend/client/providers/Auth.js"],"names":["React","useEffect","AuthContext","createContext","name","role","isAuthenticated","isLoading","AuthProvider","children","useState","setName","setRole","setAuthenticated","setLoading","setAuth","value","initializeAuth","console","log","fetch","credentials","response","status","json","data","useAuth","context","useContext","undefined","Error","useIsAuthenticated","getName","getRole"],"mappings":";;;;;;;;;;;;;AACA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC,C,CAEA;;AACA,IAAMC,WAAW,gBAAGF,KAAK,CAACG,aAAN,CAAoB;AACvCC,EAAAA,IAAI,EAAE,IADiC;AAEvCC,EAAAA,IAAI,EAAE,IAFiC;AAGvCC,EAAAA,eAAe,EAAE,KAHsB;AAIvCC,EAAAA,SAAS,EAAE,IAJ4B,CAKvC;;AALuC,CAApB,CAApB,C,CAQA;;AACA,OAAO,IAAMC,YAAY,GAAG,SAAfA,YAAe,OAAkB;AAAA;;AAAA,MAAfC,QAAe,QAAfA,QAAe;;AAAA,wBACrBT,KAAK,CAACU,QAAN,CAAe,IAAf,CADqB;AAAA;AAAA,MACtCN,IADsC;AAAA,MAChCO,OADgC;;AAAA,yBAErBX,KAAK,CAACU,QAAN,CAAe,IAAf,CAFqB;AAAA;AAAA,MAEtCL,IAFsC;AAAA,MAEhCO,OAFgC;;AAAA,yBAGDZ,KAAK,CAACU,QAAN,CAAe,KAAf,CAHC;AAAA;AAAA,MAGtCJ,eAHsC;AAAA,MAGrBO,gBAHqB;;AAAA,yBAIbb,KAAK,CAACU,QAAN,CAAe,IAAf,CAJa;AAAA;AAAA,MAItCH,SAJsC;AAAA,MAI3BO,UAJ2B;;AAM7C,MAAMC,OAAO,GAAG,SAAVA,OAAU,CAACC,KAAD;AAAA,WAAWH,gBAAgB,CAACG,KAAD,CAA3B;AAAA,GAAhB,CAN6C,CAQ7C;;;AACAf,EAAAA,SAAS,CAAC,YAAM;AACf,QAAMgB,cAAc;AAAA,2EAAG;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA,qBAClBX,eADkB;AAAA;AAAA;AAAA;;AAErBY,gBAAAA,OAAO,CAACC,GAAR,CAAY,uBAAZ;AAFqB;;AAAA;AAAA;AAAA;AAAA,uBAUEC,KAAK,CAAC,kBAAD,EAAqB;AAACC,kBAAAA,WAAW,EAAE;AAAd,iBAArB,CAVP;;AAAA;AAUfC,gBAAAA,QAVe;;AAAA,sBAYjBA,QAAQ,CAACC,MAAT,KAAoB,GAZH;AAAA;AAAA;AAAA;;AAapBL,gBAAAA,OAAO,CAACC,GAAR,CAAY,aAAZ;AAboB;AAAA,uBAcDG,QAAQ,CAACE,IAAT,EAdC;;AAAA;AAcdC,gBAAAA,IAdc;AAepBZ,gBAAAA,gBAAgB,CAAC,IAAD,CAAhB;AACAC,gBAAAA,UAAU,CAAC,KAAD,CAAV;AACAH,gBAAAA,OAAO,CAACc,IAAI,CAACrB,IAAN,CAAP;AACIC,gBAAAA,KAlBgB,GAkBToB,IAAI,CAACpB,IAlBI;AAmBpBO,gBAAAA,OAAO,CAACP,KAAD,CAAP;AAnBoB;AAAA;;AAAA;AAsBpB;AACAa,gBAAAA,OAAO,CAACC,GAAR,CAAY,mBAAZ;AACAL,gBAAAA,UAAU,CAAC,KAAD,CAAV;;AAxBoB;AAAA;AAAA;;AAAA;AAAA;AAAA;AA4BrBI,gBAAAA,OAAO,CAACC,GAAR,CAAY,sBAAZ;AACAL,gBAAAA,UAAU,CAAC,KAAD,CAAV;;AA7BqB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAH;;AAAA,sBAAdG,cAAc;AAAA;AAAA;AAAA,OAApB;;AAiCAA,IAAAA,cAAc;AACd,GAnCQ,EAmCN,EAnCM,CAAT;AAqCA,SACC,MAAC,WAAD,CAAa,QAAb;AAAsB,IAAA,KAAK,EAAE;AAAEX,MAAAA,eAAe,EAAfA,eAAF;AAAmBC,MAAAA,SAAS,EAATA,SAAnB;AAA8BH,MAAAA,IAAI,EAAJA,IAA9B;AAAoCC,MAAAA,IAAI,EAAJA,IAApC;AAA0CU,MAAAA,OAAO,EAAPA,OAA1C;AAAmDJ,MAAAA,OAAO,EAAPA,OAAnD;AAA4DC,MAAAA,OAAO,EAAPA;AAA5D,KAA7B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACEH,QADF,CADD;AAKA,CAnDM;;GAAMD,Y;;KAAAA,Y;AAqDb,OAAO,SAASkB,OAAT,GAAmB;AAAA;;AACzB,MAAMC,OAAO,GAAG3B,KAAK,CAAC4B,UAAN,CAAiB1B,WAAjB,CAAhB;;AACA,MAAIyB,OAAO,KAAKE,SAAhB,EAA2B;AAC1B,UAAM,IAAIC,KAAJ,CAAU,sBAAV,CAAN;AACA;;AACD,SAAOH,OAAP;AACA;;IANeD,O;;AAQhB,OAAO,SAASK,kBAAT,GAA8B;AAAA;;AACpC,MAAMJ,OAAO,GAAGD,OAAO,EAAvB;AACA,SAAOC,OAAO,CAACrB,eAAf;AACA;;IAHeyB,kB;UACCL,O;;;AAIjB,OAAO,SAASM,OAAT,GAAmB;AAAA;;AACzB,MAAML,OAAO,GAAGD,OAAO,EAAvB;AACA,SAAOC,OAAO,CAACvB,IAAf;AACA;;IAHe4B,O;UACCN,O;;;AAIjB,OAAO,SAASO,OAAT,GAAmB;AAAA;;AACzB,MAAMN,OAAO,GAAGD,OAAO,EAAvB;AACA,SAAOC,OAAO,CAACtB,IAAf;AACA;;IAHe4B,O;UACCP,O","sourcesContent":["\nimport React, { useEffect } from 'react';\n\n// set context\nconst AuthContext = React.createContext({\n\tname: null,\n\trole: null,\n\tisAuthenticated: false,\n\tisLoading: true,\n\t// setAuthenticated: () => {},\n});\n\n// wraps around children component and add context\nexport const AuthProvider = ({ children }) => {\n\tconst [name, setName] = React.useState(null);\n\tconst [role, setRole] = React.useState(null);\n\tconst [isAuthenticated, setAuthenticated] = React.useState(false);\n\tconst [isLoading, setLoading] = React.useState(true);\n\t\n\tconst setAuth = (value) => setAuthenticated(value);\n\n\t// verify cookie against server\n\tuseEffect(() => {\n\t\tconst initializeAuth = async () => {\n\t\t\tif (isAuthenticated) {\n\t\t\t\tconsole.log('already authenticated');\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t\n\t\t\ttry {\n\t\t\t\t// const response = await fetch('http://localhost:8080/mylocalfunction/', {credentials: 'include'});\n\t\t\t\t// const response = await fetch('http://localhost:5000/api/auth/verify', {credentials: 'include'});\n\t\t\t\t//const response = await fetch('https://67590a5d-49be-4eb3-a302-c90be94feb62-faas-http.tenant.us10.functions.xfs.cloud.sap/mylocalhttptrigger/', {credentials: 'include'});\n\t\t\t\tconst response = await fetch('/api/auth/verify', {credentials: 'include'});\n\n\t\t\t\tif (response.status === 200) {\n\t\t\t\t\tconsole.log('server okay');\n\t\t\t\t\tconst data = await response.json();\n\t\t\t\t\tsetAuthenticated(true);\n\t\t\t\t\tsetLoading(false);\n\t\t\t\t\tsetName(data.name);\n\t\t\t\t\tlet role = data.role;\n\t\t\t\t\tsetRole(role);\n\n\t\t\t\t} else {\n\t\t\t\t\t// console.log(response.statusText);\n\t\t\t\t\tconsole.log('not authenticated');\n\t\t\t\t\tsetLoading(false);\n\n\t\t\t\t}\n\t\t\t} catch (error) {\n\t\t\t\tconsole.log('server might be down');\n\t\t\t\tsetLoading(false);\n\n\t\t\t}\n\t\t};\n\t\tinitializeAuth();\n\t}, []);\n\n\treturn (\n\t\t<AuthContext.Provider value={{ isAuthenticated, isLoading, name, role, setAuth, setName, setRole }}>\n\t\t\t{children}\n\t\t</AuthContext.Provider>\n\t);\n};\n\nexport function useAuth() {\n\tconst context = React.useContext(AuthContext);\n\tif (context === undefined) {\n\t\tthrow new Error('missing AuthProvider');\n\t}\n\treturn context;\n}\n\nexport function useIsAuthenticated() {\n\tconst context = useAuth();\n\treturn context.isAuthenticated;\n}\n\nexport function getName() {\n\tconst context = useAuth();\n\treturn context.name;\n}\n\nexport function getRole() {\n\tconst context = useAuth();\n\treturn context.role;\n}"]},"metadata":{},"sourceType":"module"}